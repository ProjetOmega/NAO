{% extends "OmegaNAOBundle::layout.html.twig" %}

{% block title %}
	Ajouter une observation - {{ parent() }}
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
	<link rel="stylesheet" href="{{ asset('css/bootstrap-datepicker.min.css') }}" />
{% endblock %}

{% block naobundle_body %}
	<h1 class="text-center">Ajouter une observation</h1>
	<hr>
	{% if app.session.flashBag.has('success') %}
		<div class="alert alert-success">
			{% for message in app.session.flashbag.get('success') %}
		        <p>{{ message }}</p>
		    {% endfor %}
	    </div>
	{% endif %}
	

	<div class="well">
	  {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}

	  {# Les erreurs générales du formulaire. #}
	  {{ form_errors(form) }}

	  {# Génération manuelle et éclatée : #}
	  <div class="form-group">
	    {# Génération du label. #}
	    {{ form_label(form.espece, "Espèce", {'label_attr': {'class': 'col-sm-2'}}) }}

	    {# Affichage des erreurs pour ce champ précis. #}
	    {{ form_errors(form.espece) }}

	    <div class="col-md-10">
	      {# Génération de l'input. #}
	      {{ form_widget(form.espece, {'attr': {'data-provide': 'typeahead'}}) }}
	    </div>
	  </div>

	  <div class="form-group">
	    {# Génération du label. #}
	    {{ form_label(form.date, "Date d'observation", {'label_attr': {'class': 'col-sm-2'}}) }}

	    {# Affichage des erreurs pour ce champ précis. #}
	    {{ form_errors(form.date) }}

	    <div class="col-md-10">
	      {# Génération de l'input. #}
	      {{ form_widget(form.date, {'attr': {'placeholder': 'jj/mm/aaaa', 'class': 'js-datepicker'}}) }}
	    </div>
	  </div>

	  <div class="form-group">
	    {# Génération du label. #}
	    {{ form_label(form.commentaire, "Commentaire", {'label_attr': {'class': 'col-sm-2'}}) }}

	    {# Affichage des erreurs pour ce champ précis. #}
	    {{ form_errors(form.commentaire) }}

	    <div class="col-md-10">
	      {# Génération de l'input. #}
	      {{ form_widget(form.commentaire) }}
	    </div>
	  </div>
	
	  <div class="form-group">
	  	<div class="col-md-10">
			<button id="geolocation"class="btn btn-primary"><i class="fa fa-location-arrow" aria-hidden="true"></i> Me trouver</button>
		</div>
	  </div>
	
	  <div class="form-group">
	  	<div class="col-md-10">
	  		<div id="map"></div>
	  	</div>
	  </div>

	  <div class="form-group">
	    {# Génération du label. #}
	    {{ form_label(form.longitude, "Longitude", {'label_attr': {'class': 'col-sm-2'}}) }}

	    {# Affichage des erreurs pour ce champ précis. #}
	    {{ form_errors(form.longitude) }}

	    <div class="col-md-10">
	      {# Génération de l'input. #}
	      {{ form_widget(form.longitude) }}
	    </div>
	  </div>

	  <div class="form-group">
	    {# Génération du label. #}
	    {{ form_label(form.latitude, "Latitude", {'label_attr': {'class': 'col-sm-2'}}) }}

	    {# Affichage des erreurs pour ce champ précis. #}
	    {{ form_errors(form.latitude) }}

	    <div class="col-md-10">
	      {# Génération de l'input. #}
	      {{ form_widget(form.latitude) }}
	    </div>
	  </div>

	  <div class="form-group">
	    {# Génération du label. #}
	    {{ form_label(form.photo, "Ajouter une photo (JPG | max. 1024 Ko)", {'label_attr': {'class': 'col-sm-5'}}) }}

	    {# Affichage des erreurs pour ce champ précis. #}
	    {{ form_errors(form.photo) }}

	    <div class="col-md-10">
	      {# Génération de l'input. #}
	      {{ form_widget(form.photo) }}
	    </div>
	  </div>
	
	  <div class="form-group">
	  	<div class="col-md-10">	
	  		<button type="submit" class="btn btn-success">
	  			<i class="fa fa-plus" aria-hidden="true"></i> Ajouter une observation
	  		</button>
	  	</div>
	  </div>



	  {# Génération automatique des champs pas encore écrits.
	     Dans cet exemple, ce serait le champ CSRF (géré automatiquement par Symfony !)
	     et tous les champs cachés (type « hidden »). #}
	  {{ form_rest(form) }}

	  {# Fermeture de la balise <form> du formulaire HTML #}
	  {{ form_end(form) }}
	</div>
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="{{ asset('js/bootstrap3-typeahead.js')}}"></script>
	<script>
           var noms = {% if noms is defined %}
           	{{ noms|json_encode|raw }}
           	{% else %} null
           	{% endif %}
       </script>
	<script src="{{ asset('js/autocomplete.js') }}"></script>
	<script src="{{ asset('js/localisation.js') }}"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDtE4xVHrJdaSivopE-_T93pQfJ41Z3Hds&callback=initMap" async defer>
    </script>
    <script src="{{ asset('js/bootstrap-datepicker.min.js') }}"></script>
    <script src="{{ asset('js/bootstrap-datepicker.fr.min.js') }}"></script>
    <script src="{{ asset('js/datepicker.js') }}"></script>

{% endblock %}
